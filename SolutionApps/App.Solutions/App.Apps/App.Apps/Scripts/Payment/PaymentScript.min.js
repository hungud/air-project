function toTitleCase(n){return n.replace(/(?:^|\s)\w/g,function(n){return n.toUpperCase()})}function GetUserContactDetails(){var n=CommonConfiguration.searchBoxService+"/GetContactDetailsByUserID",t=localStorage.getItem("loginUID");$.ajax({cache:!1,url:n,data:{UserID:parseInt(t)},type:"POST",async:!1,cors:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},contentType:"application/json; charset=utf-8",dataType:"xml",success:function(n){console.log(n);$(n).find("ContactDetail").each(function(){PaymentMethod=$(this).find("PaymentMethod").text();CreditCardNumber=$(this).find("CreditCardNumber").text();CreditCardName=$(this).find("CreditCardName").text();CreditCardExpDate=$(this).find("CreditCardExpDate").text();var n="",t="",i="";CreditCardExpDate.length>0&&(n=CreditCardExpDate.split("-"),t=n[0],i=n[1]);CVV=$(this).find("CVV").text();UserLocation=$(this).find("UserLocation").text();UserStreetAddress=$(this).find("UserStreetAddress").text();UserZip=$(this).find("UserZip").text();UserPhone=$(this).find("UserPhone").text();UserEmail=$(this).find("UserEmail").text();$("#selPICCType").val(PaymentMethod);$("#txtPICCNumber").val(CreditCardNumber);$("#txtPICCHName").val(CreditCardName);$("#selectPICCMonth").val(t);$("#selectPICCYear").val(i);$("#txtPIVCNumber").val(CVV);$("#selBCICountry").val(UserLocation);$("#txtBCICity").val(UserStreetAddress);$("#txtBCIZip").val(UserZip);$("#txtBCIBillPhone").val(UserPhone);$("#txtBCIEmail").val(UserEmail)})},error:function(){},failure:function(){}})}function GetOriginDestination(){var n,u;try{function t(n){var t;HideWaitProgress();t=JSON.parse(n);sessionStorage.setItem("Origin",t.origin);sessionStorage.setItem("Destination",t.destination);sessionStorage.setItem("SelectionType",t.SelectionName);var u=sessionStorage.getItem("Origin"),f=sessionStorage.getItem("Destination"),s=sessionStorage.getItem("SelectionType"),e=u.split(";"),o=f.split(";"),i=[],r=[];e.forEach(function(n){if(n.length>0){var t=n,r=t.indexOf("["),u=t.indexOf("]"),t=t.substring(r+1,u);i.push(t)}});o.forEach(function(n){if(n.length>0){var t=n,i=t.indexOf("["),u=t.indexOf("]"),t=t.substring(i+1,u);r.push(t)}});sessionStorage.departarraynew!=""&&sessionStorage.departarraynew!=null?sessionStorage.setItem("departarray",sessionStorage.departarraynew):sessionStorage.setItem("departarray",JSON.stringify(i));sessionStorage.setItem("arrivalarray",JSON.stringify(r))}function i(){HideWaitProgress()}n={folderName:localStorage.getItem("RequestID"),SearchText:"QuoteRQ.log"};MasterAppConfigurationsServices("GET",CommonConfiguration.WebAPIServicesURL+"API/CommonService/GetQuoteRQRSService",n,t,i);HideWaitProgress()}catch(r){u=r}}function calculateAge(n){var t=new Date(n),i=new Date(sessionStorage.getItem("LastDepartureDate")),r=(i-t)/(365.25*864e5);return r.toFixed(5)}function filterTime(n){var t=n.split(":");return("0"+t[0]).slice(-2)+":"+("0"+t[1]).slice(-2)}function ValidateData(){var u,n,t,i,r;try{if(ValidateTravelerDetails()){if(u=sessionStorage.getItem("CompanyTypeId"),$("#selPICCType").val().trim()=="Select a Payment Card")return ConfirmBootBox("Successfully","Please Enter Payment Method.","App_Warning",initialCallbackYes,initialCallbackNo),$("#selPICCType").focus(),!1;if($("#selPICCType").val().trim()!="CQ"){if($("#txtPICCNumber").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Credit or Debit Card Number.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPICCNumber").focus(),!1;if($("#txtPIVCNumber").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Card Verification Number.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPIVCNumber").focus(),!1;if($("#txtPICCHName").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Card Holder Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPICCHName").focus(),!1;if(n=$("#txtPICCHName").val().trim(),t=/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi.test(n),t)return ConfirmBootBox("Successfully","Card Holder Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPICCHName").focus(),!1;if(!ValidateTravelerPassangerAndCreaditCardHolder())return ConfirmBootBox("Successfully","Card Holder Name Should be one of the Adult Passanger Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPICCHName").focus(),!1}if(i=$("#selBCICountry").val().split(",").length,i!=3)return ConfirmBootBox("Successfully","Please Select Valid City.","App_Warning",initialCallbackYes,initialCallbackNo),$("#selBCICountry").focus(),!1;if($("#txtBCIZip").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Zip.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIZip").focus(),!1;if($("#txtBCIBillPhone").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Billing Phone.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIBillPhone").focus(),!1;if($("#txtBCIBillPhone").val().trim().length!=10)return ConfirmBootBox("Successfully","Please Enter valid Phone.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIBillPhone").focus(),!1;if($("#txtBCIEmail").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter E-Mail ID.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIEmail").focus(),!1;if(!ValidateEmail($("#txtBCIEmail").val().trim()))return ConfirmBootBox("Successfully","Please Enter Vailid E-Mail ID.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIEmail").focus(),!1;if(r=sessionStorage.getItem("Insurance"),r=="False"){if(!$("input[name='radioNameTravelIns']:checked").val())return ConfirmBootBox("Successfully","Please Select Travel Protection Option.","App_Warning",initialCallbackYes,initialCallbackNo),$("#radioNameTravelIns").focus(),!1}else if(!$("input[name='radioNameTravelIns1']:checked").val())return ConfirmBootBox("Successfully","Please Select Travel Insurance Option.","App_Warning",initialCallbackYes,initialCallbackNo),$("#radioNameTravelIns").focus(),!1;return $("#txtpolicy").prop("checked")?!0:(ConfirmBootBox("Successfully","Please Select Travel Rules and Restrictions.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtpolicy").focus(),!1)}}catch(f){}}function ValidateInsuranceData(){var t,n;try{if(ValidateTravelerDetails()){if(t=sessionStorage.getItem("CompanyTypeId"),$("#selPICCType").val().trim()=="Select a Payment Card")return ConfirmBootBox("Successfully","Please Enter Payment Method.","App_Warning",initialCallbackYes,initialCallbackNo),$("#selPICCType").focus(),!1;if($("#selPICCType").val().trim()!="CQ"){if($("#txtPICCNumber").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Credit or Debit Card Number.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPICCNumber").focus(),!1;if($("#txtPIVCNumber").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Card Verification Number.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPIVCNumber").focus(),!1;if($("#txtPICCHName").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Card Holder Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPICCHName").focus(),!1;if(!ValidateTravelerPassangerAndCreaditCardHolder())return ConfirmBootBox("Successfully","Card Holder Name Should be one of the Adult Passanger Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtPICCHName").focus(),!1}return(n=$("#selBCICountry").val().split(",").length,n!=3)?(ConfirmBootBox("Successfully","Please Select Valid City.","App_Warning",initialCallbackYes,initialCallbackNo),$("#selBCICountry").focus(),!1):$("#txtBCIZip").val().trim()==""?(ConfirmBootBox("Successfully","Please Enter Zip.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIZip").focus(),!1):$("#txtBCIBillPhone").val().trim()==""?(ConfirmBootBox("Successfully","Please Enter Billing Phone.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIBillPhone").focus(),!1):$("#txtBCIBillPhone").val().trim().length!=10?(ConfirmBootBox("Successfully","Please Enter valid Phone.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIBillPhone").focus(),!1):$("#txtBCIEmail").val().trim()==""?(ConfirmBootBox("Successfully","Please Enter E-Mail ID.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIEmail").focus(),!1):ValidateEmail($("#txtBCIEmail").val().trim())?!0:(ConfirmBootBox("Successfully","Please Enter Vailid E-Mail ID.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtBCIEmail").focus(),!1)}}catch(i){}}function ValidateTravelerDetails(){var n=!0,t=/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi;try{$.each(myPassengerDetailsListArray,function(i,r){var f,e,s,o,u;if(parseInt(r.Adults)>0)for(u=0;u<parseInt(r.Adults);u++){if($("#txtFirstNameAdults"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Adult First Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameAdults"+u+"").focus(),n=!1;if(f=$("#txtFirstNameAdults"+u+"").val().trim(),e=t.test(f),e)return ConfirmBootBox("Successfully","Adult First Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameAdults"+u+"").focus(),n=!1;if($("#txtMiddleNameAdults"+u+"").val().trim()!=""&&(f=$("#txtMiddleNameAdults"+u+"").val().trim(),e=t.test(f),e))return ConfirmBootBox("Successfully","Adult Middle Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtMiddleNameAdults"+u+"").focus(),n=!1;if($("#txtLastNameAdults"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Adult Last Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameAdults"+u+"").focus(),n=!1;if(f=$("#txtLastNameAdults"+u+"").val().trim(),e=t.test(f),e)return ConfirmBootBox("Successfully","Adult Last Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameAdults"+u+"").focus(),n=!1;if($("#txtDOBDateAdults"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Adult DOB.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateAdults"+u+"").focus(),n=!1;if(s=new Date($("#txtDOBDateAdults"+u+"").val()),o=calculateAge(s),o<2)return ConfirmBootBox("Successfully","According to Date Of Birth passenger is not Adult please select passenger type Infant and search again.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateInfants"+u+"").focus(),n=!1;if(o<12)return ConfirmBootBox("Successfully","According to Date Of Birth passenger is not Adult please select passenger type Children and search again.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateInfants"+u+"").focus(),n=!1}if(parseInt(r.Childrens)>0)for(u=0;u<parseInt(r.Childrens);u++){if($("#txtFirstNameChildrens"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Children First Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameChildrens"+u+"").focus(),n=!1;if(f=$("#txtFirstNameChildrens"+u+"").val().trim(),e=t.test(f),e)return ConfirmBootBox("Successfully","Children First Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameChildrens"+u+"").focus(),n=!1;if($("#txtMiddleNameChildrens"+u+"").val().trim()!=""&&(f=$("#txtMiddleNameChildrens"+u+"").val().trim(),e=t.test(f),e))return ConfirmBootBox("Successfully","Children Middle Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtMiddleNameChildrens"+u+"").focus(),n=!1;if($("#txtLastNameChildrens"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Children Last Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameChildrens"+u+"").focus(),n=!1;if(f=$("#txtLastNameChildrens"+u+"").val().trim(),e=t.test(f),e)return ConfirmBootBox("Successfully","Children Last Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameChildrens"+u+"").focus(),n=!1;if($("#txtDOBDateChildrens"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Children DOB.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateChildrens"+u+"").focus(),n=!1;if(s=new Date($("#txtDOBDateChildrens"+u+"").val()),o=calculateAge(s),o<2)return ConfirmBootBox("Successfully","According to Date Of Birth passenger is no more Child please select passenger type Infant and search again.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateChildrens"+u+"").focus(),n=!1;if(o>12)return ConfirmBootBox("Successfully","According to Date Of Birth passenger is no more Child please select passenger type Adult and search again.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateChildrens"+u+"").focus(),n=!1}if(parseInt(r.Infants)>0)for(u=0;u<parseInt(r.Infants);u++){if($("#txtFirstNameInfants"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Infants First Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameInfants"+u+"").focus(),n=!1;if(f=$("#txtFirstNameInfants"+u+"").val().trim(),e=t.test(f),e)return ConfirmBootBox("Successfully","Infant First Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameInfants"+u+"").focus(),n=!1;if($("#txtMiddleNameInfants"+u+"").val().trim()!=""&&(f=$("#txtMiddleNameInfants"+u+"").val().trim(),e=t.test(f),e))return ConfirmBootBox("Successfully","Infant Middle Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtMiddleNameInfants"+u+"").focus(),n=!1;if($("#txtLastNameInfants"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Infants Last Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameInfants"+u+"").focus(),n=!1;if(f=$("#txtLastNameInfants"+u+"").val().trim(),e=t.test(f),e)return ConfirmBootBox("Successfully","Infant Last Name Cannot Have Special Characters or Symbols","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameInfants"+u+"").focus(),n=!1;if($("#txtDOBDateInfants"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Infants DOB.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateInfants"+u+"").focus(),n=!1;if(s=new Date($("#txtDOBDateInfants"+u+"").val()),o=calculateAge(s),o>2)return ConfirmBootBox("Successfully","According to Date Of Birth passenger is no more Infant please select passenger type Child and search again.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateInfants"+u+"").focus(),n=!1}if(parseInt(r.OnSeat)>0)for(u=0;u<parseInt(r.OnSeat);u++){if($("#txtFirstNameOnSeat"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter OnSeat First Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameOnSeat"+u+"").focus(),n=!1;if($("#txtLastNameOnSeat"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter OnSeat Last Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameOnSeat"+u+"").focus(),n=!1;if($("#txtDOBDateOnSeat"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter OnSeat DOB.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateOnSeat"+u+"").focus(),n=!1}if(parseInt(r.Seniors)>0)for(u=0;u<parseInt(r.Seniors);u++){if($("#txtFirstNameSeniors"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Seniors First Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtFirstNameSeniors"+u+"").focus(),n=!1;if($("#txtLastNameSeniors"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Seniors Last Name.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtLastNameSeniors"+u+"").focus(),n=!1;if($("#txtDOBDateSeniors"+u+"").val().trim()=="")return ConfirmBootBox("Successfully","Please Enter Seniors DOB.","App_Warning",initialCallbackYes,initialCallbackNo),$("#txtDOBDateSeniors"+u+"").focus(),n=!1}})}catch(i){}return n}function convertDate(n){function i(n){return n<10?"0"+n:n}var t=new Date(n);return[t.getFullYear(),i(t.getMonth()+1),i(t.getDate())].join("-")}function convertDateInfant(n){var t=new Date(n),i=t.getDate(),r=t.getMonth(),u=t.getFullYear().toString().substr(-2);return i+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r]+u}function ValidateTravelerPassangerAndCreaditCardHolder(){var n=!0;try{return $.each(myPassengerDetailsListArray,function(t,i){var r,e,o,u,f;if(parseInt(i.Adults)>0)for(r=0;r<parseInt(i.Adults);r++)if(e=$("#txtFirstNameAdults"+r+"").val().trim()+$("#txtLastNameAdults"+r+"").val().trim(),o=$("#txtPICCHName").val().trim().split(" ").join(""),e.toLowerCase()!=o.toLowerCase()){if($("#txtPICCHName").val().trim().split(" ").length==2&&(u=$("#txtPICCHName").val().trim().split(" ")[0],f=$("#txtPICCHName").val().trim().split(" ")[1],$("#txtFirstNameAdults"+r+"").val().trim().toLowerCase()==u&&$("#txtLastNameAdults"+r+"").val().trim().toLowerCase()==f)||$("#txtPICCHName").val().trim().split(" ").length==3&&(u=$("#txtPICCHName").val().trim().split(" ")[0],f=$("#txtPICCHName").val().trim().split(" ")[2],$("#txtFirstNameAdults"+r+"").trim().val().toLowerCase()==u&&$("#txtLastNameAdults"+r+"").val().trim().toLowerCase()==f))return n=!0;n=!1}else return n=!0}),n}catch(t){}return n}function tConvert(n){return n=n.toString().match(/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/)||[n],n.length>1&&(n=n.slice(1),n[5]=+n[0]<12?"AM":"PM",n[0]=+n[0]%12||12),n.join("")}function GetPaymentOptions(){var n=sessionStorage.getItem("CompanyTypeId"),t=sessionStorage.getItem("Id"),i=CommonConfiguration.WebSSOURL+"api/CommonService//GetpaymentOptionsByTypeId";$.ajax({cache:!1,async:!1,url:i,data:{CompanyTypeId:n,CompanyId:t},type:"GET",cors:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.length>0){var t=$("#selPICCType");$.each(n,function(n,i){t.append("<option value='"+i.CardValue+"' >"+i.CardType+"<\/option>")})}},error:function(){},failure:function(){}})}function LoadAirReservationResultData(n){var p,f,h,t,et,ot,d,l,g,o,st,v,y,ut,r,ct;try{if(n.Message=="Success"&&n.Status==!0){var yt=sessionStorage.getItem("PurchasedDate"),lt=sessionStorage.getItem("Price"),at=sessionStorage.getItem("PolicyNumber");sessionStorage.removeItem("IsFromPaymentPage");SelectedAirLineBokingPayment_Data=JSON.parse(localStorage.getItem("SolutionData_App_Data_Traveler|_|SelectedAirLineBokingPayment"))[0];p=JSON.parse(localStorage.getItem("SolutionData_App_Data_Traveler|_|AirReservationBookingRequest"));Reqst_flightsDetailsList_Resource=p.flightsDetailsList[0];Reqst_passengersDetail_Resource=p.passengersDetailsList[0];Reqst_CCD_Resource=p.creditCardOtherDetails[0];$(".AirBokingConfirmation-Panel").removeClass("hidden");$(".AirBokingPayment-Panel").addClass("hidden");var u=n.Data,w="",pt=u.flights_details.length;$.each(u.flights_details,function(n,t){var i;if(console.log("----------------------"),i=localStorage.getItem("SelectionName"),w=i=="2"?"<div class='time-title'>Departure: "+u.flights_details[0].DepartureDate+"<span><i class='glyphicon glyphicon-play'><\/i> Return: "+t.ArrivalDate+"<\/span><\/div><p style='padding:5px;'>"+localStorage.getItem("Origin")+"<\/br><i class='glyphicon glyphicon-play'><\/i>"+localStorage.getItem("Destination")+"<\/p>":"<p style='padding:5px;'>Departure: "+u.flights_details[0].DepartureDate+"<\/p><p style='padding:5px;'>"+localStorage.getItem("Origin")+"<\/br><i class='glyphicon glyphicon-play'><\/i>"+localStorage.getItem("Destination")+"<\/p>",i=="3"){var r=SolutionDataTraveler("GET","AirPortNameCodeCoList"),f=r.filter(function(n){return n.airlinecode===u.flights_details[0].DepartureCityCode}),e=f[0].airlinename,o=r.filter(function(n){return n.airlinecode===t.ArrivalCityCode}),s=o[0].airlinename;w="<div class='time-title'>Departure: "+u.flights_details[0].DepartureDate+"<span><i class='glyphicon glyphicon-play'><\/i> Return: "+t.ArrivalDate+"<\/span><\/div><p style='padding:5px;'>"+e+"<\/br><i class='glyphicon glyphicon-play'><\/i>"+s+"<\/p>"}});$("#confirmation_title").empty().append(w);f="";f+="<div class='col-md-6 '>";f+="<p class='prep_for'>PREPARED FOR<\/p>";$.each(u.passengers_details,function(n,t){var r=t.passengername,i=t.passengername.split(" ").filter(function(n){return n.replace(/(\r\n|\n|\r)/gm,"")});i.length==3&&(r=t.Surname+" "+i[1]+" "+i[2]+" "+i[0]);i.length==2&&(r=t.Surname+" "+i[1]+" "+i[0]);f+=" <p>"+r});f+="<p>Booking Confirmation Code  :  "+u.pnrnumber+"<br />Airline Reservation Code  "+u.AirLineReservationCode+"<\/p>";f+="<\/div>";f+="<div class='col-md-6 '>";f+=" <p style='padding-top:15px;'>"+n.AgencyDetails;f+=" <br /><h5>DATE & TIME OF BOOKING : "+$.formatDateTime("DD dd M yy",new Date((new Date).toJSON()))+"<\/h5><\/p>";f+="<\/div>";$("#Confirmation_PreparedFor").empty().append(f);var i="",nt="",tt="",e=0,s=0,wt=u.flights_details.length;dest_array=JSON.parse(sessionStorage.getItem("departarray"));arrival_array=JSON.parse(sessionStorage.getItem("arrivalarray"));var b=sessionStorage.getItem("SelectionType"),it=0,c=SolutionDataTraveler("GET","AirPortNameCodeCoList");$.each(u.flights_details,function(n,t){if(t.DepartureCityCode==null)return!0;var v=dest_array[it],y=arrival_array[it],u=[],r=[];if(c!=undefined&&($.each(c,function(n,t){var r=t.airportname.indexOf("All Airports"),i;t.airlinecode==v&&t.airportname.indexOf("All Airports")>-1&&(i=t.city,$.each(c,function(n,t){t.city==i&&u.push(t.iata)}))}),u.length==0&&u.push(v)),c!=undefined&&($.each(c,function(n,t){var u=t.airportname.indexOf("All Airports"),i;t.airlinecode==y&&t.airportname.indexOf("All Airports")>-1&&(i=t.city,$.each(c,function(n,t){t.city==i&&r.push(t.iata)}))}),r.length==0&&r.push(y)),u.indexOf(t.DepartureCityCode)===-1&&r.indexOf(t.DepartureCityCode)===-1){var h="",p="",w="",l="";nt!=""&&(p=nt,w=t.DepartureDateTime,h=timeDiff(w,p),Hour=Math.floor(Math.abs(h.minutes)/60),l=Math.abs(h.minutes)%60,b=="3"&&Hour>24||(e+=parseInt(parseInt(Hour*60)+parseInt(l)),i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab layover' style='text-align:center; margin-top:15px;'>",i+="<tr><td colspan='4'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Layover: "+Hour+"H "+l+"M <\/td><\/tr>",i+="<\/table>",s+=1))}if(r.indexOf(t.DepartureCityCode)>-1){var a=s==0?"NonStop":s==1?"1 Stop":"2+ Stop",f=Math.floor(Math.abs(e)/60),o=Math.abs(e)%60;i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab layover' style='text-align:center; margin-top:15px;'>";i+="<tr><td colspan='4' style='background-color: white;'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+f+"H "+o+"M ("+a+")<\/td><\/tr>";i+="<\/table>";tt=t.Sequence;e=0;s=0}var k=t.ElapsedTime.split("."),f=k[0],o=k[1];if(e+=parseInt(parseInt(f*60)+parseInt(o)),nt=t.ArrivalDateTime1,i+="<div class='row'><div class='col-md-12'><div class='col-md-12 orng_title'><div class='time-title'>DEPARTURE: "+t.DepartureDate+" <i class='glyphicon glyphicon-play'><\/i> ARRIVAL: "+t.ArrivalDate+"  <i class='fa fa-plane fa-1'><\/i><\/div><br><p><span>Please verify flight times prior to departure<\/span><\/p><\/div><\/div><\/div>",i+="<div class='row'><div class='col-md-12'><div class='col-md-12 no-padding'>",i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab' style='text-align:inherit; margin-top:15px;'>",i+=window.location.href.indexOf("/air")>-1?"<tr><td><img src='/air/Content/Images/Airlines_Logo/"+t.MarketingAirline+".gif'  alt=''><\/td>  <td><p style='margin-bottom:4px;'> <strong> Flight # "+(t.AirlineName==null?t.MarketingAirline:t.AirlineName)+"  "+t.FlightNumber.replace(/^0+/,"")+"<\/strong>  <\/p><p>"+(t.AirlineName==null?Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.MarketingAirline):Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.AirlineName))+"<\/p><\/td>":"<tr><td><img src='/Content/Images/Airlines_Logo/"+t.MarketingAirline+".gif'  alt=''><\/td> <td><p style='margin-bottom:4px;'> <strong> Flight # "+(t.AirlineName==null?t.MarketingAirline:t.AirlineName)+"  "+t.FlightNumber.replace(/^0+/,"")+"<\/strong>  <\/p><p>"+(t.AirlineName==null?Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.MarketingAirline):Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.AirlineName))+"<\/p><\/td>",i+="<td> "+AirPort_Name(t.DepartureCityCode)+"<\/p><p>Departing: "+t.DepartureDate+" At "+tConvert(t.DepartureTime)+"<\/p><p><strong>Terminal:<\/strong>"+(t.DepartureTerminal==null?"Not Available":t.DepartureTerminal.replace("TERMINAL",""))+"<\/p><\/td><td><p>"+AirPort_Name(t.ArrivalCityCode)+"<\/p><p>Arriving: "+t.ArrivalDate+" At "+tConvert(t.ArrivalTime)+"<\/p><p><strong>Terminal:<\/strong>"+(t.ArrivalTerminal==null?"Not Available":t.ArrivalTerminal.replace("TERMINAL",""))+"<\/p><\/td><td rowspan='2'><p>Aircraft:"+t.AircraftType+"<\/p><p>Duration: "+f+"H "+o+"M<\/p><\/td><\/tr>",b=="1"||b=="3"){if(r.indexOf(t.ArrivalCityCode)>-1){var a=s==0?"NonStop":s==1?"1 Stop":"2+ Stop",f=Math.floor(Math.abs(e)/60),o=Math.abs(e)%60;i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab layover' style='text-align:center; margin-top:15px;'>";i+="<tr><td colspan='4' style='background-color: white;'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+f+"H "+o+"M ("+a+")<\/td><\/tr>";i+="<\/table>";tt=t.Sequence;e=0;it+=1}}else if(b=="2"&&u.indexOf(t.ArrivalCityCode)>-1){var a=s==0?"NonStop":s==1?"1 Stop":"2+ Stop",f=Math.floor(Math.abs(e)/60),o=Math.abs(e)%60;i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab' style='text-align:center; margin-top:15px;'>";i+="<tr><td colspan='4' style='background-color: white;'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+f+"H "+o+"M ("+a+")<\/td><\/tr>";i+="<\/table>";tt=t.Sequence;e=0}i+="<\/table><\/div><\/div><\/div>";t.status=="false"&&$("#error_title_title").empty().append("Booking is not yet confirm, SkyFlight Customer service team will get back to you once the booking is confirmed in next 24 hours.")});i+="<\/div>";$("#Confirmation_FlightDetails").empty().append(i);h="";h+="<div id='tabs-1'>  ";h+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table table-striped' style='text-align:inherit;'>";h+="<thead class='thead-inverse'>";h+="<tr><th>Passenger Name<\/th><th>Seats<\/th><th>Class<\/th><th>Status<\/th><th>Meals<\/th><\/tr><\/thead>";$.each(u.passengers_details,function(n,t){var r=t.passengername,i=t.passengername.split(" ").filter(function(n){return n.replace(/(\r\n|\n|\r)/gm,"")});i.length==3&&(r=t.Surname+" "+i[1]+" "+i[2]+" "+i[0]);i.length==2&&(r=t.Surname+" "+i[1]+" "+i[0]);h+=" <tr><td>"+r+"<\/td><td>Check-In Required<\/td><td>Economy<\/td><td>Confirmed<\/td><td>Meals<\/td><\/tr>"});h+="<\/table><\/div>";$("#Confirmation_passengetDetails").empty().append(h);t="";t+="<div class='row'>";t+="<div class='col-md-12'>";t+="<div class='col-md-12 orng_bg top'><strong>Payment Detail:<\/strong><\/div>";Reqst_CCD_Resource.CardType!="CQ"&&(t+="<div class='col-md-4'>Name On The Card:<\/div>",t+="<div class='col-md-6 no-padding'>"+toTitleCase(Reqst_CCD_Resource.NameOnCard.toLowerCase()),+ "</div>");t+="<\/div>";t+="<\/div>";t+="<div class=''>";t+="<div class='col-md-12'>";Reqst_CCD_Resource.CardType!="CQ"&&(t+="<div class='col-md-4'>Credit Card Charged:<\/div>",t+="<div class='col-md-6 no-padding'>****-****-****-"+Reqst_CCD_Resource.CardNumber.substr(12,4),+ "</div>");t+="<\/div>";t+="<\/div>";var a=parseFloat(sessionStorage.getItem("mapublishedfare")),k=parseFloat(sessionStorage.getItem("cpublishedfare")),ft=0,rt=parseFloat(CCFEE).toFixed(2);if(ft=parseFloat(u.currCode_details.PaymentAmount).toFixed(2),t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Amount Charged:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+ft+"<\/div>",t+="<\/div>",rt>0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>CCFEE:<\/div>",t+=a>0||k>0?"<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+rt+"<span style='color:red;'> (Separate charge of Credit Card fee will appear on the credit card)<\/span> <\/div>":"<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+rt+" <\/div>",t+="<\/div>"),et=sessionStorage.getItem("CompanyTypeId"),et=="2"){var a=parseFloat(sessionStorage.getItem("mapublishedfare")),k=parseFloat(sessionStorage.getItem("cpublishedfare")),vt=a+k;a>0&&k>0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Service Fee:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+vt.toFixed(2)+"<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span> <\/div>",t+="<\/div>");a>0&&k<=0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Service Fee:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+a.toFixed(2)+"<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span> <\/div>",t+="<\/div>")}else PublishFareMessage="Separate charge of service fee will appear on the credit card",ot=parseFloat(sessionStorage.getItem("mapublishedfare")),ot>0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Service Fee:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+sessionStorage.getItem("mapublishedfare")+"<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span> <\/div>",t+="<\/div>");if(at!=""){for(d=lt.split(";"),t+="<div class='row'>",t+="<div class='col-md-12'>",t+="<div class='col-md-12 orng_bg top'><strong>Insurance Detail:<\/strong><\/div>",l=0;l<d.length;l++)parseFloat(d[l])>0&&(t+="<div class='col-md-4'>Passenger "+(l+1)+":<\/div>",t+="<div class='col-md-6 no-padding'>"+d[l]+"<\/div>");t+="<\/div>";t+="<\/div>"}t+="<div class='col-md-12'>";t+="<div class='col-md-12 orng_bg'><strong>Billing Detail:<\/strong><\/div>";g=Reqst_passengersDetail_Resource.passengername;o=Reqst_passengersDetail_Resource.passengername.split(" ").filter(function(n){return n.replace(/(\r\n|\n|\r)/gm,"")});o.length==4&&(g=o[3]+" "+o[1]+" "+o[2]+" "+o[0]);o.length==3&&(g=o[2]+" "+o[1]+" "+o[0]);t+="<div class='col-md-6'>"+g+"<br>"+Reqst_passengersDetail_Resource.passengerAddress+"<br>"+Reqst_passengersDetail_Resource.email+"<br>"+Reqst_passengersDetail_Resource.PhoneNumber+"<\/div>";t+="<\/div>";t+="<div class='row'>";t+="<div class='col-md-12'>";t+="<div class='col-md-6 pad_bot25'><\/div>";t+="<\/div>";t+="<\/div>";$("#Confirmation_PaymentDetail").empty().append(t);$(".AirBokingConfirmation-Panel").addClass("visible");$("html, body").animate({scrollTop:0},500);st=n.ErrorCode.startsWith("OK");st==!0?(v=sessionStorage.getItem("Hotel"),y=sessionStorage.getItem("CarRental"),v=="True"&&y=="True"?($("#footer-buttons").removeClass("hidden"),$("#btn-hotel").removeClass("hidden"),$("#btn-car").removeClass("hidden")):v=="True"&&y=="False"?($("#footer-buttons").removeClass("hidden"),$("#btn-hotel").removeClass("hidden"),$("#btn-car").addClass("hidden")):v=="False"&&y=="True"?($("#footer-buttons").removeClass("hidden"),$("#btn-hotel").addClass("hidden"),$("#btn-car").removeClass("hidden")):v=="False"&&y=="False"&&$("#footer-buttons").addClass("hidden"),$("html, body").animate({scrollTop:0},500)):($(".AirBokingConfirmation-Panel").removeClass("hidden"),$(".AirBokingPayment-Panel").addClass("hidden"),$(".AirBokingConfirmation-Panel").addClass("visible"),$("#footer-buttons").addClass("hidden"),r="",ut=sessionStorage.getItem("CCEnableAir"),ut=="False"||ut==""?(r+="<div class='row'>",r+="<div class='' style='color:red'>Thank you for booking with us, we are processing your booking.<\/div>",r+="<\/div>"):(PublishFareMessage!=""&&(r+="<div class='row'>",r+="<div class='col-md-12' style='color:red'>"+PublishFareMessage+"<\/div>",r+="<\/div>"),r+="<div class='row'>",r+="<div class='col-md-12' style='color:red'>Payment for the following booking was not successful. Selected Fare is not guaranteed until paid in full. Please contact the agency and provide an alternate payment information to guarantee the selected Fare.<\/div>",r+="<\/div>"),$("#error_title_title").empty().append(r),$("html, body").animate({scrollTop:0},500))}else n.Message==""?($(".AirBokingConfirmation-Panel").removeClass("hidden"),$(".AirBokingPayment-Panel").addClass("hidden"),r="",r+="<div class='row'>",r+="<div class='col-md-12'>",r+=n.ErrorCode=="INVLD ACT CODE SEGMENT 01"?"<div class='col-md-12 orng_bg top'><strong>Seats for the selected fare are gone, please click the button below 'Select Another Fare' and select another fare from the quote page<\/strong><\/div>":"<div class='col-md-12 orng_bg top'><strong>Selected fare has already been sold, please click the button below 'Select Another Fare' and select another fare from the quote page<\/strong><\/div>",r+="<div class='col-md-6'><a href='http://bookings.skyflight.ca/air' class='btn btn-primary'>Select Another Fare<\/a><\/div>",r+="<\/div>",r+="<\/div>",$("#error_title_title").empty().append(r),$("#footer-buttons").addClass("hidden"),$("#confirmation-section").addClass("hidden"),$("#confirmationprepared-section").addClass("hidden"),$("html, body").animate({scrollTop:0},500)):($(".AirBokingPayment-Panel").removeClass("hidden"),$(".AirBokingConfirmation-Panel").addClass("hidden"));$("html, body").animate({scrollTop:0},500);HideWaitProgress()}catch(ht){ct=ht;ct=ht;HideWaitProgress()}}function LoadAirReservationMulticityResultData(n){var p,o,s,t,ut,ft,b,c,et,v,y,it,r,st;try{if(n.Message=="Success"&&n.Status==!0){var at=sessionStorage.getItem("PurchasedDate"),ht=sessionStorage.getItem("Price"),ct=sessionStorage.getItem("PolicyNumber");sessionStorage.removeItem("IsFromPaymentPage");SelectedAirLineBokingPayment_Data=JSON.parse(localStorage.getItem("SolutionData_App_Data_Traveler|_|SelectedAirLineBokingPayment"))[0];p=JSON.parse(localStorage.getItem("SolutionData_App_Data_Traveler|_|AirReservationBookingRequest"));Reqst_flightsDetailsList_Resource=p.flightsDetailsList[0];Reqst_passengersDetail_Resource=p.passengersDetailsList[0];Reqst_CCD_Resource=p.creditCardOtherDetails[0];$(".AirBokingConfirmation-Panel").removeClass("hidden");$(".AirBokingPayment-Panel").addClass("hidden");var f=n.Data,k="",vt=f.flights_details.length;$.each(f.flights_details,function(n,t){console.log(f.flights_details);console.log("----------------------");var i=localStorage.getItem("SelectionName");k=i=="2"?"<div class='time-title'>Departure: "+f.flights_details[0].DepartureDate+"<span><i class='glyphicon glyphicon-play'><\/i> Return: "+t.ArrivalDate+"<\/span><\/div><p style='padding:5px;'>"+localStorage.getItem("Origin")+"<\/br><i class='glyphicon glyphicon-play'><\/i>"+localStorage.getItem("Destination")+"<\/p>":"<p style='padding:5px;'>Departure: "+f.flights_details[0].DepartureDate+"<\/p><p style='padding:5px;'>"+localStorage.getItem("Origin")+"<\/br><i class='glyphicon glyphicon-play'><\/i>"+localStorage.getItem("Destination")+"<\/p>"});$("#confirmation_title").empty().append(k);o="";o+="<div class='col-md-6 '>";o+="<p class='prep_for'>PREPARED FOR<\/p>";$.each(f.passengers_details,function(n,t){var r=t.passengername,i=t.passengername.split(" ").filter(function(n){return n.replace(/(\r\n|\n|\r)/gm,"")});i.length==3&&(r=i[2]+" "+i[0]+" "+i[1]+" "+t.Surname);i.length==2&&(r=i[0]+" "+t.Surname+" "+i[1]);o+=" <p>"+r});o+="<p>Booking Confirmation Code  :  "+f.pnrnumber+"<br />Airline Reservation Code  "+f.AirLineReservationCode+"<\/p>";o+="<\/div>";o+="<div class='col-md-6 '>";o+=" <p style='padding-top:15px;'>"+n.AgencyDetails;o+=" <br /><h5>DATE & TIME OF BOOKING : "+$.formatDateTime("DD dd M yy g:ii a",new Date((new Date).toJSON()))+"<\/h5><\/p>";o+="<\/div>";$("#Confirmation_PreparedFor").empty().append(o);var i="",d="",l="",u=0,e=0,yt=f.flights_details.length;dest_array=JSON.parse(sessionStorage.getItem("departarray"));arrival_array=JSON.parse(sessionStorage.getItem("arrivalarray"));var g=sessionStorage.getItem("SelectionType"),nt=0,h=SolutionDataTraveler("GET","AirPortNameCodeCoList");$.each(f.flights_details,function(n,t){var r,f,o,y;if(t.DepartureCityCode==null)return!0;var p=dest_array[nt],w=arrival_array[nt],c=[],s=[];if(h!=undefined&&($.each(h,function(n,t){var r=t.airportname.indexOf("All Airports"),i;t.airlinecode==p&&t.airportname.indexOf("All Airports")>-1&&(i=t.city,$.each(h,function(n,t){t.city==i&&c.push(t.iata)}))}),c.length==0&&c.push(p)),h!=undefined&&($.each(h,function(n,t){var r=t.airportname.indexOf("All Airports"),i;t.airlinecode==w&&t.airportname.indexOf("All Airports")>-1&&(i=t.city,$.each(h,function(n,t){t.city==i&&s.push(t.iata)}))}),s.length==0&&s.push(w)),c.indexOf(t.DepartureCityCode)===-1&&s.indexOf(t.DepartureCityCode)===-1){var a="",b="",k="",v="";d!=""&&(b=d,k=t.DepartureDateTime,a=timeDiff(k,b),Hour=Math.floor(Math.abs(a.minutes)/60),v=Math.abs(a.minutes)%60,u+=parseInt(parseInt(Hour*60)+parseInt(v)),i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab layover' style='text-align:center; margin-top:15px;'>",i+="<tr><td colspan='4'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Layover: "+Hour+"H "+v+"M <\/td><\/tr>",i+="<\/table>",e+=1)}r="";f="";s.indexOf(t.DepartureCityCode)>-1?(o=e==0?"NonStop":e==1?"1 Stop":"2+ Stop",r=Math.floor(Math.abs(u)/60),f=Math.abs(u)%60,(r>0||f>0)&&(i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab layover' style='text-align:center; margin-top:15px;'>",i+="<tr><td colspan='4'><i class='fa fa-clock-o' aria-hidden='true'><\/i>Total Trip Duration :  "+r+"H "+f+"M ("+o+")<\/td><\/tr>",i+="<\/table>",l=t.Sequence,u=0,e=0)):s.indexOf(t.DepartureCityCode)==-1&&(o=e==0?"NonStop":e==1?"1 Stop":"2+ Stop",r=Math.floor(Math.abs(u)/60),f=Math.abs(u)%60,(r>0||f>0)&&(i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab' style='text-align:center; margin-top:15px;'>",i+="<tr><td colspan='4' style='background-color: white;'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+r+"H "+f+"M ("+o+")<\/td><\/tr>",i+="<\/table>",l=t.Sequence,u=0));y=t.ElapsedTime.split(".");r=y[0];f=y[1];u+=parseInt(parseInt(r*60)+parseInt(f));d=t.ArrivalDateTime1;i+="<div class='row'><div class='col-md-12'><div class='col-md-12 orng_title'><div class='time-title'>DEPARTURE: "+t.DepartureDate+" <i class='glyphicon glyphicon-play'><\/i> ARRIVAL: "+t.ArrivalDate+"  <i class='fa fa-plane fa-1'><\/i><\/div><br><p><span>Please verify flight times prior to departure<\/span><\/p><\/div><\/div><\/div>";i+="<div class='row'><div class='col-md-12'><div class='col-md-12 no-padding'>";i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab' style='text-align:inherit; margin-top:15px;'>";i+=window.location.href.indexOf("/air")>-1?"<tr><td rowspan='2'><p style='margin-bottom:4px;'><img src='/air/Content/Images/Airlines_Logo/"+t.MarketingAirline+".gif'  alt=''> <strong> Flight # "+(t.AirlineName==null?t.MarketingAirline:t.AirlineName)+"  "+t.FlightNumber.replace(/^0+/,"")+"<\/strong>  <\/p><p>"+(t.AirlineName==null?Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.MarketingAirline):Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.AirlineName))+"<\/p><\/td>":"<tr><td rowspan='2'><p style='margin-bottom:4px;'><img src='/Content/Images/Airlines_Logo/"+t.MarketingAirline+".gif'  alt=''> <strong> Flight # "+(t.AirlineName==null?t.MarketingAirline:t.AirlineName)+"  "+t.FlightNumber.replace(/^0+/,"")+"<\/strong>  <\/p><p>"+(t.AirlineName==null?Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.MarketingAirline):Airline_Name(t.MarketingAirline)+"<\/p><p>Operated By "+Airline_Name(t.AirlineName))+"<\/p><\/td>";i+="<td> "+AirPort_Name(t.DepartureCityCode)+"<\/p><p>Departing: "+t.DepartureDate+" At "+tConvert(t.DepartureTime)+"<\/p><p><strong>Terminal:<\/strong>"+(t.DepartureTerminal==null?"Not Available":t.DepartureTerminal.replace("TERMINAL",""))+"<\/p><\/td><td><p>"+AirPort_Name(t.ArrivalCityCode)+"<\/p><p>Arriving: "+t.ArrivalDate+" At "+tConvert(t.ArrivalTime)+"<\/p><p><strong>Terminal:<\/strong>"+(t.ArrivalTerminal==null?"Not Available":t.ArrivalTerminal.replace("TERMINAL",""))+"<\/p><\/td><td rowspan='2'><p>Aircraft:"+t.AircraftType+"<\/p><p>Duration: "+r+"H "+f+"M<\/p><\/td><\/tr>";g=="1"||g=="3"?s.indexOf(t.ArrivalCityCode)>-1&&(o=e==0?"NonStop":e==1?"1 Stop":"2+ Stop",r=Math.floor(Math.abs(u)/60),f=Math.abs(u)%60,(r>0||f>0)&&(i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab layover' style='text-align:center; margin-top:15px;'>",i+="<tr><td colspan='4' style='background-color: white;'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+r+"H "+f+"M ("+o+")<\/td><\/tr>",i+="<\/table>",l=t.Sequence,u=0,nt+=1)):g=="2"&&c.indexOf(t.ArrivalCityCode)>-1&&(o=e==0?"NonStop":e==1?"1 Stop":"2+ Stop",r=Math.floor(Math.abs(u)/60),f=Math.abs(u)%60,(r>0||f>0)&&(i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab' style='text-align:center; margin-top:15px;'>",i+="<tr><td colspan='4' style='background-color: white;'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+r+"H "+f+"M ("+o+")<\/td><\/tr>",i+="<\/table>",l=t.Sequence,u=0));s.indexOf(t.DepartureCityCode)>-1&&(o=e==0?"NonStop":e==1?"1 Stop":"2+ Stop",r=Math.floor(Math.abs(u)/60),f=Math.abs(u)%60,(r>0||f>0)&&(i+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table without_tab' style='text-align:center; margin-top:15px;'>",i+="<tr><td colspan='4' style='background-color: white;'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+r+"H "+f+"M ("+o+")<\/td><\/tr>",i+="<\/table>",l=t.Sequence,u=0));i+="<\/table><\/div><\/div><\/div>";t.status=="false"&&$("#error_title_title").empty().append("Booking is not yet confirm, SkyFlight Customer service team will get back to you once the booking is confirmed in next 24 hours.")});i+="<\/div>";$("#Confirmation_FlightDetails").empty().append(i);s="";s+="<div id='tabs-1'>  ";s+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='table table-striped' style='text-align:inherit;'>";s+="<thead class='thead-inverse'>";s+="<tr><th>Passenger Name<\/th><th>Seats<\/th><th>Class<\/th><th>Status<\/th><th>Meals<\/th><\/tr><\/thead>";$.each(f.passengers_details,function(n,t){var r=t.passengername,i=t.passengername.split(" ").filter(function(n){return n.replace(/(\r\n|\n|\r)/gm,"")});i.length==3&&(r=i[2]+" "+i[0]+" "+i[1]+" "+t.Surname);i.length==2&&(r=i[0]+" "+t.Surname+" "+i[1]);s+=" <tr><td>"+r+"<\/td><td>Check-In Required<\/td><td>Economy<\/td><td>Confirmed<\/td><td>Meals<\/td><\/tr>"});s+="<\/table><\/div>";$("#Confirmation_passengetDetails").empty().append(s);t="";t+="<div class='row'>";t+="<div class='col-md-12'>";t+="<div class='col-md-12 orng_bg top'><strong>Payment Detail:<\/strong><\/div>";t+="<div class='col-md-4'>Name On The Card:<\/div>";t+="<div class='col-md-6 no-padding'>"+toTitleCase(Reqst_CCD_Resource.NameOnCard.toLowerCase());+ "</div>";t+="<\/div>";t+="<\/div>";t+="<div class=''>";t+="<div class='col-md-12'>";t+="<div class='col-md-4'>Credit Card Charged:<\/div>";t+="<div class='col-md-6 no-padding'>****-****-****-"+Reqst_CCD_Resource.CardNumber.substr(12,4);+ "</div>";t+="<\/div>";t+="<\/div>";var a=parseFloat(sessionStorage.getItem("mapublishedfare")),w=parseFloat(sessionStorage.getItem("cpublishedfare")),rt=0,tt=parseFloat(CCFEE).toFixed(2);if(rt=parseFloat(f.currCode_details.PaymentAmount).toFixed(2),t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Amount Charged:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+rt+"<\/div>",t+="<\/div>",tt>0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>CCFEE:<\/div>",t+=a>0||w>0?"<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+tt+"<span style='color:red;'> (Separate charge of Credit Card fee will appear on the credit card)<\/span> <\/div>":"<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+tt+" <\/div>",t+="<\/div>"),ut=sessionStorage.getItem("CompanyTypeId"),ut=="2"){var a=parseFloat(sessionStorage.getItem("mapublishedfare")),w=parseFloat(sessionStorage.getItem("cpublishedfare")),lt=a+w;a>0&&w>0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Service Fee:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+lt.toFixed(2)+"<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span> <\/div>",t+="<\/div>");a>0&&w<=0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Service Fee:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+a.toFixed(2)+"<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span> <\/div>",t+="<\/div>")}else PublishFareMessage="Separate charge of service fee will appear on the credit card",ft=parseFloat(sessionStorage.getItem("mapublishedfare")),ft>0&&(t+="<div class='col-md-12'>",t+="<div class='col-md-4'>Service Fee:<\/div>",t+="<div class='col-md-6 no-padding'> "+sessionStorage.getItem("CurrencyCode")+" "+sessionStorage.getItem("mapublishedfare")+"<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span> <\/div>",t+="<\/div>");if(ct!=""){for(b=ht.split(";"),t+="<div class='row'>",t+="<div class='col-md-12'>",t+="<div class='col-md-12 orng_bg top'><strong>Insurance Detail:<\/strong><\/div>",c=0;c<b.length;c++)parseFloat(b[c])>0&&(t+="<div class='col-md-4'>Passenger "+(c+1)+":<\/div>",t+="<div class='col-md-6 no-padding'>"+b[c]+"<\/div>");t+="<\/div>";t+="<\/div>"}t+="<div class='col-md-12'>";t+="<div class='col-md-12 orng_bg'><strong>Billing Detail:<\/strong><\/div>";t+="<div class='col-md-6'>"+Reqst_passengersDetail_Resource.passengername+"<br>"+Reqst_passengersDetail_Resource.passengerAddress+"<br>"+Reqst_passengersDetail_Resource.email+"<br>"+Reqst_passengersDetail_Resource.PhoneNumber+"<\/div>";t+="<\/div>";t+="<div class='row'>";t+="<div class='col-md-12'>";t+="<div class='col-md-6 pad_bot25'><\/div>";t+="<\/div>";t+="<\/div>";$("#Confirmation_PaymentDetail").empty().append(t);$(".AirBokingConfirmation-Panel").addClass("visible");$("html, body").animate({scrollTop:0},500);et=n.ErrorCode.startsWith("OK");et==!0?(v=sessionStorage.getItem("Hotel"),y=sessionStorage.getItem("CarRental"),v=="True"&&y=="True"?($("#footer-buttons").removeClass("hidden"),$("#btn-hotel").removeClass("hidden"),$("#btn-car").removeClass("hidden")):v=="True"&&y=="False"?($("#footer-buttons").removeClass("hidden"),$("#btn-hotel").removeClass("hidden"),$("#btn-car").addClass("hidden")):v=="False"&&y=="True"?($("#footer-buttons").removeClass("hidden"),$("#btn-hotel").addClass("hidden"),$("#btn-car").removeClass("hidden")):v=="False"&&y=="False"&&$("#footer-buttons").addClass("hidden"),$("html, body").animate({scrollTop:0},500)):($(".AirBokingConfirmation-Panel").removeClass("hidden"),$(".AirBokingPayment-Panel").addClass("hidden"),$(".AirBokingConfirmation-Panel").addClass("visible"),$("#footer-buttons").addClass("hidden"),r="",it=sessionStorage.getItem("CCEnableAir"),it=="False"||it==""?(r+="<div class='row'>",r+="<div class='' style='color:red'>Thank you for booking with us, we are processing your booking.<\/div>",r+="<\/div>"):(PublishFareMessage!=""&&(r+="<div class='row'>",r+="<div class='col-md-12' style='color:red'>"+PublishFareMessage+"<\/div>",r+="<\/div>"),r+="<div class='row'>",r+="<div class='col-md-12' style='color:red'>Payment for the following booking was not successful. Selected Fare is not guaranteed until paid in full. Please contact the agency and provide an alternate payment information to guarantee the selected Fare.<\/div>",r+="<\/div>"),$("#error_title_title").empty().append(r),$("html, body").animate({scrollTop:0},500))}else n.Message==""?($(".AirBokingConfirmation-Panel").removeClass("hidden"),$(".AirBokingPayment-Panel").addClass("hidden"),r="",r+="<div class='row'>",r+="<div class='col-md-12'>",r+=n.ErrorCode=="INVLD ACT CODE SEGMENT 01"?"<div class='col-md-12 orng_bg top'><strong>Seats for the selected fare are gone, please click the button below 'Select Another Fare' and select another fare from the quote page<\/strong><\/div>":"<div class='col-md-12 orng_bg top'><strong>Selected fare has already been sold, please click the button below 'Select Another Fare' and select another fare from the quote page<\/strong><\/div>",r+="<div class='col-md-6'><a href='http://bookings.skyflight.ca/air' class='btn btn-primary'>Select Another Fare<\/a><\/div>",r+="<\/div>",r+="<\/div>",$("#error_title_title").empty().append(r),$("#footer-buttons").addClass("hidden"),$("#confirmation-section").addClass("hidden"),$("#confirmationprepared-section").addClass("hidden"),$("html, body").animate({scrollTop:0},500)):($(".AirBokingPayment-Panel").removeClass("hidden"),$(".AirBokingConfirmation-Panel").addClass("hidden"));$("html, body").animate({scrollTop:0},500);HideWaitProgress()}catch(ot){st=ot;st=ot;HideWaitProgress()}}function AirBookingPaymentForm(){var u,h,o,rt,g;try{if(u=JSON.parse(localStorage.getItem("SolutionData_App_Data_Traveler|_|SelectedAirLineBokingPayment")),u!="undefined"&&u!=null){var r="",ut="",f="";FilterAllFlightSegment_Array=[];$.each(u,function(n,t){$.each(t.FlightSegments,function(n,t){FilterAllFlightSegment_Array.push(t)})});h=[];$.each(FilterAllFlightSegment_Array,function(n,t){r=t.AirItineraryPricingInfo.ItinTotalFare.TotalFare;ut=t.FlightNumber;f=t.FlightNumber;h.push({DepartureDate:t.DepartureDateTime,ArrivalDate:t.ArrivalDateTime.slice,AirlineName:t.ArrivalAirport.LocationCode,FlightNumber:t.FlightNumber,DepartureCityCode:t.DepartureAirport.LocationCode,DepartureTime:t.DepartureDateTime.slice(0,-3),DepartureTerminal:t.DepartureAirport.LocationCode,ArrivalCityCode:t.ArrivalAirport.LocationCode,ArrivalTime:t.ArrivalDateTime.slice(0,-3),ArrivalTerminal:t.ArrivalAirport.LocationCode,DistanceTravel:"0",AircraftType:t.Equipment[0].AirEquipType,DepartureDateTime:t.DepartureDateTime.slice(0,-3),ArrivalDateTime:t.ArrivalDateTime.slice(0,-3),BookingClass:"0",FlightTime:t.DepartureDateTime.slice(0,-3),DirectionInd:"0",DepAirportLocationCode:t.DepartureAirport.LocationCode,OperatingAirlineCode:t.OperatingAirline.Code,ArrAirportLocationCode:t.ArrivalAirport.LocationCode,Equipment:t.Equipment[0].AirEquipType,MarketingAirline:t.MarketingAirline.Code,NoofPassengers:"1",resBookDesigCode:t.ResBookDesigCode,status:"NN"})});var e=[],n=0;myPassengerDetailsListArray=JSON.parse(localStorage.getItem("SolutionData_App_Data_Traveler|_|GetPassengerDetailsList"));$.each(myPassengerDetailsListArray,function(t,i){for(var u,o,r=0;r<parseInt(i.Adults);r++)n=n+1,u=$("#txtFirstNameAdults"+r+"").val()+" "+($("#txtMiddleNameAdults"+r+"").val()==""?"":$("#txtMiddleNameAdults"+r+"").val()+" ")+" "+$("#SelTDTitleAdults"+r+"").val().replace(".","").toUpperCase(),o=$("#SelTDTitleAdults"+r+"").val().replace(".","").toUpperCase()+" "+$("#txtFirstNameAdults"+r+"").val()+" "+$("#txtMiddleNameAdults"+r+"").val()+" "+$("#txtLastNameAdults"+r+"").val(),e.push({passengerType:"Adults",passengername:o,passengerAddress:$("#txtBCICity").val()==""?$("#selBCICountry").val():$("#txtBCICity").val()+" , "+$("#selBCICountry").val(),ReservationCode:$("#txtBCIZip").val(),airlineName:f,email:$("#txtBCIEmail").val(),DepartureCityCode:$("#txtPICCNumber").val(),DepartureTime:$("#txtPICCNumber").val(),DepartureTerminal:$("#txtPICCNumber").val(),IsInfant:"false",DateofBirth:convertDate($("#txtDOBDateAdults"+r+"").val()),PhoneLocationCode:$("#txtBCIBillPhone").val(),PassengerNameNumber:n+".1",PhoneNumber:$("#txtBCIBillPhone").val(),PhoneUseType:"H",PassengerEmail:$("#txtBCIEmail").val(),PassengerNameRef:"ADT00"+r,Gender:$("#selTDGenderAdults"+r+"").val(),GivenName:u,Surname:$("#txtLastNameAdults"+r+"").val(),InsurancePrice:$("#passenger"+(n-1)).val()});for(r=0;r<parseInt(i.Childrens);r++)n=n+1,u=$("#SelTDTitleChildrens"+r+"").val().replace(".","").toUpperCase()+" "+$("#txtFirstNameChildrens"+r+"").val()+" "+$("#txtMiddleNameChildrens"+r+"").val(),o=$("#SelTDTitleChildrens"+r+"").val().replace(".","").toUpperCase()+" "+$("#txtFirstNameChildrens"+r+"").val()+" "+$("#txtMiddleNameChildrens"+r+"").val()+" "+$("#txtLastNameChildrens"+r+"").val(),e.push({passengerType:"Childrens",passengername:o,passengerAddress:$("#txtBCICity").val()==""?$("#selBCICountry").val():$("#txtBCICity").val()+" , "+$("#selBCICountry").val(),ReservationCode:$("#txtBCIZip").val(),airlineName:f,email:$("#txtBCIEmail").val(),DepartureCityCode:$("#txtPICCNumber").val(),DepartureTime:$("#txtPICCNumber").val(),DepartureTerminal:$("#txtPICCNumber").val(),DateofBirth:convertDate($("#txtDOBDateChildrens"+r+"").val()),PhoneLocationCode:$("#txtBCIBillPhone").val(),PassengerNameNumber:n+".1",PhoneNumber:$("#txtBCIBillPhone").val(),PhoneUseType:"H",PassengerEmail:$("#txtBCIEmail").val(),PassengerNameRef:"CHD00"+r,Gender:$("#selTDGenderChildrens"+r+"").val(),GivenName:u,Surname:$("#txtLastNameChildrens"+r+"").val(),InsurancePrice:$("#passenger"+(n-1)).val()});for(r=0;r<parseInt(i.Infants);r++)n=n+1,u=$("#SelTDTitleInfants"+r+"").val().replace(".","").toUpperCase()+" "+$("#txtFirstNameInfants"+r+"").val()+" "+$("#txtMiddleNameInfants"+r+"").val(),o=$("#SelTDTitleInfants"+r+"").val()+" "+$("#txtFirstNameInfants"+r+"").val()+" "+$("#txtMiddleNameInfants"+r+"").val(),e.push({passengerType:"Infants",passengername:o,passengerAddress:$("#txtBCICity").val()==""?$("#selBCICountry").val():$("#txtBCICity").val()+" , "+$("#selBCICountry").val(),ReservationCode:$("#txtBCIZip").val(),airlineName:f,email:$("#txtBCIEmail").val(),DepartureCityCode:$("#txtPICCNumber").val(),DepartureTime:$("#txtPICCNumber").val(),DepartureTerminal:$("#txtPICCNumber").val(),DateofBirth:convertDateInfant($("#txtDOBDateInfants"+r+"").val()),PhoneLocationCode:$("#txtBCIBillPhone").val(),PassengerNameNumber:n+".1",PhoneNumber:$("#txtBCIBillPhone").val(),PhoneUseType:"H",PassengerEmail:$("#txtBCIEmail").val(),PassengerNameRef:"INF00"+r,GivenName:u,Gender:$("#selTDGenderInfants"+r+"").val(),Surname:$("#txtLastNameInfants"+r+"").val(),InsurancePrice:$("#passenger"+(n-1)).val()})});o=[];try{o.push({CardType:$("#selPICCType").val().trim(),CardNumber:$("#txtPICCNumber").val().trim(),CVVNumber:$("#txtPIVCNumber").val().trim(),Address:$("#txtBCICity").val().trim()+"  "+$("#selBCICountry").val().trim()+"  "+$("#txtBCIZip").val().trim(),CardExpiryDate:$("#selectPICCYear").val().trim()+"-"+$("#selectPICCMonth").val().trim(),NameOnCard:$("#txtPICCHName").val().trim(),AirLineCode:FilterAllFlightSegment_Array[0].MarketingAirline.Code,CurrCode:r.CurrencyCode,PaymentAmount:parseFloat(r.Amount).toFixed(2),CCFee:$("#lblCCFee").text()})}catch(at){var c="",l="",a="",v="",nt="",y="",p="",w="",b="",k="";try{c=$("#selPICCType").val().trim()}catch(at){c="visa"}try{l=$("#txtPICCNumber").val().trim()}catch(at){l="4444333322221111"}try{a=$("#txtPIVCNumber").val().trim()}catch(at){a="909"}try{v=$("#txtBCICity").val().trim()+"  "+$("#selBCICountry").val().trim()+"  "+$("#txtBCIZip").val().trim()}catch(at){v="address"}try{nt=$("#selectPICCYear").val().trim()+"-"+$("#selectPICCMonth").val().trim()}catch(at){CardExpiryDat="2029-07"}try{y=$("#txtPICCHName").val().trim()}catch(at){y="name"}try{p=FilterAllFlightSegment_Array[0].MarketingAirline.Code}catch(at){p="FCO"}try{w=r.CurrencyCode}catch(at){w="CAD"}try{b=parseFloat(r.Amount).toFixed(2)}catch(at){b="0.00"}try{k=$("#lblCCFee").text()}catch(at){k="0.00"}o.push({CardType:c,CardNumber:l,CVVNumber:a,Address:v,CardExpiryDate:nt,NameOnCard:y,AirLineCode:p,CurrCode:w,PaymentAmount:b,CCFee:k})}var tt=sessionStorage.getItem("CompanyTypeId"),t=parseFloat(sessionStorage.getItem("mapublishedfare")),i=parseFloat(sessionStorage.getItem("cpublishedfare")),s=0,d=-1;tt=="2"?t>0&&i>0?(s=t+i,d=t):t>0&&i<=0&&(s=t,d=i+t):i>0&&(s=i);var ft=sessionStorage.getItem("CCEnableAir"),et={Name:sessionStorage.getItem("Name"),CityName:sessionStorage.getItem("CityName"),country:sessionStorage.getItem("country"),PostalCode:sessionStorage.getItem("PostalCode"),state:sessionStorage.getItem("state"),StreetAddress:sessionStorage.getItem("StreetAddress"),SmtpEmailID:sessionStorage.getItem("SmtpEmailID"),HeaderUrl:sessionStorage.getItem("HeaderUrl"),FooterUrl:sessionStorage.getItem("FooterUrl"),PrivacyUrl:sessionStorage.getItem("PrivacyUrl"),TermsUrl:sessionStorage.getItem("TermsUrl"),PhoneNumber:sessionStorage.getItem("PhoneNumber"),UserName:sessionStorage.getItem("UserName"),Password:sessionStorage.getItem("Password"),QueueNo:sessionStorage.getItem("QueueNo"),PseudoCityCode:sessionStorage.getItem("PseudoCityCode"),FromEmail:sessionStorage.getItem("FromEmail"),ToEmail:sessionStorage.getItem("ToEmail"),Domain:sessionStorage.getItem("Domain"),CurrencyCode:sessionStorage.getItem("CurrencyCode"),ServiceFee:s.toFixed(2),cpublishedfare:i,mapublishedfare:t,CompanyTypeID:tt,Commission:d,CCEnableAir:ft,Origin:localStorage.getItem("Origin"),Destination:localStorage.getItem("Destination")},ot={RequestID:localStorage.getItem("RequestID"),Locator:"",UserId:localStorage.getItem("loginUID")==null?"":localStorage.getItem("loginUID"),DefaultCompanyId:sessionStorage.getItem("Id"),BillingEmail:$("#txtBCIEmail").val(),BillingPhone:$("#txtBCIBillPhone").val(),BillingName:$("#txtPICCHName").val(),PaymentMethod:$("#selPICCType").val(),selectionkey:parseInt(sessionStorage.SelectionType)},st=sessionStorage.getItem("Origin_Final_Date"),ht=sessionStorage.getItem("Destination_Final_Date"),it="";$("#add-to-itinerary").prop("checked")==!0&&(it=$("#hdpolicycode").val().trim());rt={DATEDEP:st,DATERET:ht,PROVINCE:$("#selBCICountry").val().trim().split(",")[1],GATEWAY:localStorage.getItem("Origin"),DESTINATION:localStorage.getItem("Destination"),POLICYCODE:it,PHONE:$("#txtBCIBillPhone").val().trim(),EMAIL:$("#txtBCIEmail").val().trim(),ADDRESS:$("#txtBCICity").val().trim(),CITY:$("#selBCICountry").val().trim().split(",")[0],POSTALCODE:$("#txtBCIZip").val().trim(),COUNTRY:$("#selBCICountry").val().trim().split(",")[2],Total_Insurance_Price:$("#hdTotalPolicyAmount").val()};g={flightsDetailsList:h,passengersDetailsList:e,creditCardOtherDetails:o,_AgencyDetails:et,SaveRecords:ot,_policydetails:rt};function ct(n){var t;t=n;console.log("CCFEE-"+n.CCFEE);CCFEE=n.CCFEE;var i=n.PurchaseDate,r=n.Price,u=n.PolicyNumber;sessionStorage.setItem("PurchasedDate",i);sessionStorage.setItem("Price",r);sessionStorage.setItem("PolicyNumber",u);SolutionDataTraveler("SET","AirReservationBookingResult",t);$(".AirBokingConfirmation-Panel").removeClass("hidden");$(".AirBokingPayment-Panel").addClass("hidden");console.log(t);LoadAirReservationResultData(t)}function lt(){}localStorage.setItem("SolutionData_App_Data_Traveler|_|AirReservationBookingRequest",JSON.stringify(g));MasterAppConfigurationsServices("POST",CommonConfiguration.WebAPIServicesURL+"API/AirReservationBooking/PostAirBooking",JSON.stringify(g),ct,lt)}}catch(at){HideWaitProgress()}}function fpercent(n,t){return n*t/100}function Airline_Name(n){var t="";return $.each(SolutionDataTraveler("GET","AirLineList"),function(i,r){r.airlinecode==n&&(t=r.airlinename)}),t}function AirPort_Name(n){var t="";return $.each(SolutionDataTraveler("GET","AirPortNameCodeCoList"),function(i,r){r.airlinecode==n&&(t=r.airlinename)}),t}function GetAirline_Code(n){return n.lastIndexOf("(")>0&&n.lastIndexOf(")")>0?n.substr(n.lastIndexOf("("),n.lastIndexOf(")")).replace("(","").replace(")",""):n}function OnLoadCreateVailidatePassengerDetailsDynamically(){var n,f,t,i,r,u,o;try{myPassengerDetailsListArray=SolutionDataTraveler("GET","GetPassengerDetailsList");n="";f=0;$.each(myPassengerDetailsListArray,function(t,i){var r;for(parseInt(i.Adults)>0&&(n+="<div class='col-md-12'><div class='form-group col-md-1 ' style='width:100%; height:27px;  margin-left: 0px;'>Adults<\/div><\/div>"),n+="<input type='hidden' id='passenger"+f+"' />",f+=1,r=0;r<parseInt(i.Adults);r++)n+="<div class='col-md-12 table-responsive'>",n+="<div class='form-group col-md-1'><label class='form-control adult-1' style='width:auto; border: none; height:27px; margin-top: 0px; margin-left: 10px;'>"+(r+1)+":<\/label><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' data-i='"+r+"' id='SelTDTitleAdults"+r+"' style='width:100%; height: 27px; margin-top: 0px;'><option>Mr.<\/option><option>Ms.<\/option><option>Miss.<\/option><option>Mstr.<\/option><\/select><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off' id='txtFirstNameAdults"+r+"' name='txtFirstNameAdults"+r+"' placeholder='First Name*'  class=' form-control' style='width: 100%;float:left; height: 27px; margin-top: 0px;'  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtMiddleNameAdults"+r+"' name='txtMiddleNameAdults"+r+"' placeholder='Middle Name'  class='form-control' style='width: 100%; height: 27px; margin-top: 0px;'  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtLastNameAdults"+r+"' name='txtLastNameAdults"+r+"' placeholder='Last Name*'  class='  form-control' style='width: 100%;float:left; height: 27px; margin-top: 0px;'  /><\/div>",n+="<div class='form-group col-md-2'><div class='input-group col-xs-11 col-sm-11' style='float:left;'><input class='form-control  date-picker  Restrictinput ' id='txtDOBDateAdults"+r+"' readonly='readonly' type='text'  placeholder='Date of Birth' name='date-range-picker' data-date-format='yyyy-mm-dd' style='width:100%; height: 27px; margin-top: 0px;'  /><span class='input-group-addon'  data-i='"+r+"' id='col_txtDOBDateAdults"+r+"'><i class='fa fa-calendar bigger-80'><\/i><\/span><\/div><\/div>",n+="<div class='form-group col-md-1'><select class='form-control'  data-i='"+r+"' id='selTDGenderAdults"+r+"' style='width:100%; height:27px'><option value='M'>Male<\/option><option  value='F'>Female<\/option><\/select><\/div>",n+="<div class='space-8'><\/div><\/div>";for(parseInt(i.Childrens)>0&&(n+="<div class='col-md-12'><div class='form-group col-md-1' style='width:100%; height:27px;  margin-left: 0px;'>Children<\/div><\/div>"),r=0;r<parseInt(i.Childrens);r++)n+="<div class='col-md-12 table-responsive'>",n+="<div class='form-group col-md-1'><label class='form-control' style='width:auto; height:27px; border:none; margin-top: 0px; margin-left: 10px;'>"+(r+1)+":<\/label><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' data-i='"+r+"' id='SelTDTitleChildrens"+r+"' style='width:100%; height:27px; margin-top: 0px; '><option>Mr.<\/option><option>Ms.<\/option><option>Miss.<\/option><option>Mstr.<\/option><\/select><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtFirstNameChildrens"+r+"' name='txtFirstNameChildrens"+r+"' placeholder='First Name*'  class='col-xs-10 col-sm-5' style='width: 100%;float:left; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtMiddleNameChildrens"+r+"' name='txtMiddleNameChildrens"+r+"' placeholder='Middle Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtLastNameChildrens"+r+"' name='txtLastNameChildrens"+r+"' placeholder='Last Name*'  class='col-xs-10 col-sm-5' style='width: 100%;float:left; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><div class='input-group col-xs-11 col-sm-11' style='float:left;'><input class='form-control  date-picker  Restrictinput ' id='txtDOBDateChildrens"+r+"' readonly='readonly' type='text'  placeholder='Date of Birth'  name='date-range-picker' data-date-format='yyyy-mm-dd' style='width:96%; height:27px; margin-top: 0px; '  /><span class='input-group-addon'  data-i='"+r+"' id='col_txtDOBDateChildrens"+r+"'><i class='fa fa-calendar bigger-80'><\/i><\/span><\/div><\/div>",n+="<div class='form-group col-md-1'><select class='form-control'  data-i='"+r+"' id='selTDGenderChildrens"+r+"' style='width:100%; height:27px'><option value='M'>Male<\/option><option  value='F'>Female<\/option><\/select><\/div>",n+="<div class='space-8'><\/div><\/div>";for(parseInt(i.Infants)>0&&(n+="<div class='col-md-12'><div class='form-group col-md-1' style='width:100%; height:27px;  margin-left: 0px;'>Infants<\/div><\/div>"),r=0;r<parseInt(i.Infants);r++)n+="<div class='col-md-12 table-responsive'>",n+="<div class='form-group col-md-1'><label class='form-control' style='width:100%; height:27px; margin-top: 0px; border:none;  margin-top: 1px; margin-left: 10px;'>"+(r+1)+":<\/label><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' data-i='"+r+"' id='SelTDTitleInfants"+r+"' style='width:100%; height:27px; margin-top: 0px; ; '><option>Inf.<\/option><option>Mr.<\/option><option>Ms.<\/option><option>Miss.<\/option><option>Mstr.<\/option><\/select><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtFirstNameInfants"+r+"' name='txtFirstNameInfants"+r+"' placeholder='First Name*'  class='col-xs-10 col-sm-5' style='width: 100%; float:left; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtMiddleNameInfants"+r+"' name='txtMiddleNameInfants"+r+"' placeholder='Middle Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtLastNameInfants"+r+"' name='txtLastNameInfants"+r+"' placeholder='Last Name*'  class='col-xs-10 col-sm-5' style='width: 100%;float:left; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><div class='input-group col-xs-11 col-sm-11' style='float:left;'><input class='form-control  date-picker  Restrictinput ' id='txtDOBDateInfants"+r+"' readonly='readonly' type='text'  placeholder='Date of Birth'  name='date-range-picker' data-date-format='yyyy-mm-dd' style='width:100%; height:27px; margin-top: 0px; '  /><span class='input-group-addon'  data-i='"+r+"' id='col_txtDOBDateInfants"+r+"'><i class='fa fa-calendar bigger-80'><\/i><\/span><\/div><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' data-i='"+r+"'  id='selTDGenderInfants"+r+"' style='width:100%; height:27px'><option value='MI'>Male<\/option><option  value='FI'>Female<\/option><\/select><\/div>",n+="<div class='space-8'><\/div><\/div>";for(parseInt(i.OnSeat)>0&&(n+="<div class='col-md-12'><div class='form-group col-md-1' style='width:100%; height:27px;  margin-left: 0px;'>OnSeat<\/div><\/div>"),r=0;r<parseInt(i.OnSeat);r++)n+="<div class='col-md-12 table-responsive'>",n+="<div class='form-group col-md-1'><label class='form-control' style='width:100%; height:27px; margin-top: 0px; margin-left: 10px;'>"+(r+1)+":<\/label><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' data-i='"+r+"'  id='SelTDTitleOnSeat"+r+"' style='width:100%; height:27px; margin-top: 0px;  '><option>Mr.<\/option><option>Ms.<\/option><option>Miss.<\/option><option>Mstr.<\/option><option>Dr.<\/option><\/select><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtFirstNameOnSeat"+r+"' name='txtFirstNameOnSeat"+r+"' placeholder='First Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtMiddleNameOnSeat"+r+"' name='txtMiddleNameOnSeat"+r+"' placeholder='Middle Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtLastNameOnSeat"+r+"' name='txtLastNameOnSeat"+r+"' placeholder='Last Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><div class='input-group col-xs-12 col-sm-12'><input class='form-control  date-picker  Restrictinput ' id='txtDOBDateOnSeat"+r+"' type='text'  readonly='readonly' placeholder='Date of Birth'  name='date-range-picker' data-date-format='yyyy-mm-dd' style='width:100%; height:27px; margin-top: 0px; '  /><span class='input-group-addon'  data-i='"+r+"'  id='col_txtDOBDateOnSeat"+r+"'><i class='fa fa-calendar bigger-80'><\/i><\/span><\/div><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' id='selTDGenderOnSeat"+r+"' style='width:100%; height:27px'><option value='M'>Male<\/option><option  value='F'>Female<\/option><\/select><\/div>",n+="<div class='space-8'><\/div><\/div>";for(parseInt(i.Seniors)>0&&(n+="<div class='col-md-12'><div class='form-group col-md-1' style='width:100%; height:27px;  margin-left: 11px;'>Seniors<\/div><\/div>"),r=0;r<parseInt(i.Seniors);r++)n+="<div class='col-md-12 table-responsive'>",n+="<div class='form-group col-md-1'><label class='form-control' style='width:100%; height:27px; margin-top: 0px; margin-left: 10px;'>"+(r+1)+":<\/label><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' data-i='"+r+"'  id='SelTDTitleSeniors"+r+"' style='width:100%; height:27px; margin-top: 0px;  '><option>Mr.<\/option><option>Ms.<\/option><option>Miss.<\/option><option>Mstr.<\/option><option>Dr.<\/option><\/select><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtFirstNameSeniors"+r+"' name='txtFirstNameSeniors"+r+"' placeholder='First Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtMiddleNameSeniors"+r+"' name='txtMiddleNameSeniors"+r+"' placeholder='Middle Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><input type='text' autocomplete='off'  id='txtLastNameSeniors"+r+"' name='txtLastNameSeniors"+r+"' placeholder='Last Name'  class='col-xs-10 col-sm-5' style='width: 100%; height:27px; margin-top: 0px; '  /><\/div>",n+="<div class='form-group col-md-2'><div class='input-group col-xs-12 col-sm-12'><input class='form-control  date-picker  Restrictinput ' id='txtDOBDateSeniors"+r+"' type='text'   readonly='readonly' placeholder='Date of Birth'  name='date-range-picker' data-date-format='yyyy-mm-dd' style='width:100%; height:27px; margin-top: 0px; '  /><span class='input-group-addon'  data-i='"+r+"'  id='col_txtDOBDateSeniors"+r+"'><i class='fa fa-calendar bigger-80'><\/i><\/span><\/div><\/div>",n+="<div class='form-group col-md-1'><select class='form-control' id='selTDGenderSeniors"+r+"' style='width:100%; height:27px'><option value='M'>Male<\/option><option  value='F'>Female<\/option><\/select><\/div>",n+="<div class='space-8'><\/div><\/div>"});$("#BookingPassangerDetails").empty().append(n);t=new Date;t=t.getFullYear();i=new Date;i=i.getFullYear()-100;r=new Date;r=r.getFullYear()-10;u=new Date;u=u.getFullYear()-2;$.each(myPassengerDetailsListArray,function(n,f){for(var e=0;e<parseInt(f.Adults);e++){$("#txtDOBDateAdults"+e+"").datepicker({autoclose:!0,format:"yyyy-mm-dd",yearRange:i+":"+t,changeMonth:!0,changeYear:!0});$("#col_txtDOBDateAdults"+e).click(function(){$("#txtDOBDateAdults"+$(this).attr("data-i")+"").datepicker("show")});$("#SelTDTitleAdults"+e).on("change",function(){var n=$(this).find("option:selected").text();n=="Mr."||n=="Mstr."?$("#selTDGenderAdults"+$(this).attr("data-i")).val("M"):(n=="Ms."||n=="Miss.")&&$("#selTDGenderAdults"+$(this).attr("data-i")).val("F")});$("#selTDGenderAdults"+e).on("change",function(){var n=$(this).val();n=="M"?$("#SelTDTitleAdults"+$(this).attr("data-i")).val("Mr."):n=="F"&&$("#SelTDTitleAdults"+$(this).attr("data-i")).val("Ms.")});$("#txtFirstNameAdults"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())});$("#txtMiddleNameAdults"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())});$("#txtLastNameAdults"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())})}for(e=0;e<parseInt(f.Childrens);e++){$("#txtDOBDateChildrens"+e+"").datepicker({yearRange:r+":"+t,autoclose:!0,format:"yyyy-mm-dd",changeMonth:!0,changeYear:!0});$("#col_txtDOBDateChildrens"+e+"").click(function(){$("#txtDOBDateChildrens"+$(this).attr("data-i")+"").datepicker("show")});$("#SelTDTitleChildrens"+e).on("change",function(){var n=$(this).find("option:selected").text();n=="Mr."||n=="Mstr."?$("#selTDGenderChildrens"+$(this).attr("data-i")).val("M"):(n=="Ms."||n=="Miss.")&&$("#selTDGenderChildrens"+$(this).attr("data-i")).val("F")});$("#selTDGenderChildrens"+e).on("change",function(){var n=$(this).val();n=="M"?$("#SelTDTitleChildrens"+$(this).attr("data-i")).val("Mstr."):n=="F"&&$("#SelTDTitleChildrens"+$(this).attr("data-i")).val("Miss.")});$("#txtFirstNameChildrens"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())});$("#txtMiddleNameChildrens"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())});$("#txtLastNameChildrens"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())})}for(e=0;e<parseInt(f.Infants);e++){$("#txtDOBDateInfants"+e+"").datepicker({yearRange:u+":"+t,autoclose:!0,format:"yyyy-mm-dd",changeMonth:!0,changeYear:!0});$("#col_txtDOBDateInfants"+e+"").click(function(){$("#txtDOBDateInfants"+$(this).attr("data-i")+"").datepicker("show")});$("#SelTDTitleInfants"+e).on("change",function(){var n=$(this).find("option:selected").text();n=="Mr."||n=="Mstr."?$("#selTDGenderInfants"+$(this).attr("data-i")).val("MI"):(n=="Ms."||n=="Miss.")&&$("#selTDGenderInfants"+$(this).attr("data-i")).val("FI")});$("#selTDGenderInfants"+e).on("change",function(){var n=$(this).val();n=="M"?$("#SelTDTitleInfants"+$(this).attr("data-i")).val("Mstr."):n=="F"&&$("#SelTDTitleInfants"+$(this).attr("data-i")).val("Miss.")});$("#txtFirstNameInfants"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())});$("#txtMiddleNameInfants"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())});$("#txtLastNameInfants"+e).on("blur",function(){$(this).val($(this).val().toUpperCase())})}for(e=0;e<parseInt(f.OnSeat);e++)$("#txtDOBDateOnSeat"+e+"").datepicker({yearRange:i+":"+t,autoclose:!0,format:"yyyy-mm-dd",changeMonth:!0,changeYear:!0}),$("#col_txtDOBDateOnSeat"+e+"").click(function(){$("#txtDOBDateOnSeat"+$(this).attr("data-i")+"").datepicker("show")});for(e=0;e<parseInt(f.Seniors);e++)$("#txtDOBDateSeniors"+e+"").datepicker({yearRange:i+":"+t,autoclose:!0,format:"yyyy-mm-dd",changeMonth:!0,changeYear:!0}),$("#col_txtDOBDateSeniors"+e+"").click(function(){$("#txtDOBDateSeniors"+$(this).attr("data-i")+"").datepicker("show")})})}catch(e){HideWaitProgress();o=e}}function BindDisplayResutModuleDataNew(){var t,n,r,o,u,i,e;try{t=JSON.parse(localStorage.getItem("SolutionData_App_Data_Traveler|_|SelectedAirLineBokingPayment"));t!="undefined"&&t!=null&&(n="",sessionStorage.departarraynew='["'+t[0].FlightSegments[0].DepartureAirport.LocationCode+'"]',t.length>0&&(r=[],r.push({OriginDestinationFlight:t}),o=0,u="",$.each(r,function(t,i){var e=i.OriginDestinationFlight.length,s=i.OriginDestinationFlight[e-1].FlightSegments.length;sessionStorage.setItem("Origin_Final_Date",i.OriginDestinationFlight[0].FlightSegments[0].DepartureDateTime);sessionStorage.setItem("Destination_Final_Date",i.OriginDestinationFlight[e-1].FlightSegments[s-1].ArrivalDateTime);u=i.OriginDestinationFlight[e-1].FlightSegments[s-1].DepartureDateTime;sessionStorage.setItem("LastDepartureDate",u);var v=i.OriginDestinationFlight[0].FlightSegments[0].FlightSegmentID,y=t,h="",c=0,l=0,a=0,o=1;TotalAmount=i.OriginDestinationFlight[0].FlightSegments[0].AirItineraryPricingInfo.ItinTotalFare.TotalFare.Amount;n+="<div class='table-responsive'>";n+="<table class='table without_tab'><thead style='display:none;'><tr>";n+="<th colspan='5'> <div class='col-md-9'><strong> Fares:  "+i.OriginDestinationFlight[0].FlightSegments[0].AirItineraryPricingInfo.ItinTotalFare.TotalFare.CurrencyCode+"$"+i.OriginDestinationFlight[0].FlightSegments[0].AirItineraryPricingInfo.ItinTotalFare.BaseFare.Amount+" + "+i.OriginDestinationFlight[0].FlightSegments[0].AirItineraryPricingInfo.ItinTotalFare.Taxes.Tax[0].CurrencyCode+"$"+i.OriginDestinationFlight[0].FlightSegments[0].AirItineraryPricingInfo.ItinTotalFare.Taxes.Tax[0].Amount+" (taxes) = "+i.OriginDestinationFlight[0].FlightSegments[0].AirItineraryPricingInfo.ItinTotalFare.TotalFare.CurrencyCode+"$"+i.OriginDestinationFlight[0].FlightSegments[0].AirItineraryPricingInfo.ItinTotalFare.TotalFare.Amount+"<\/strong><br> <small class='gray'>Final Total Price(incl fee)<\/small> <\/div>";n+="<div class='col-md-3 rt-align'>";n+="<\/div><\/th><\/tr><\/thead>";n+="<tbody class='pink-bg'>";n+=" <tr class='txt-yellow'>";n+=" <td colspan='5'><i class='fa fa-check' aria-hidden='true'><\/i> Best Price Guarantee! <\/td>";n+="<\/tr>";n+="<\/tbody>";var f="",r="";$.each(i.OriginDestinationFlight,function(t,i){var s,u,e;a=i.FlightSegments.length;s=i.FlightSegments.length;o=1;f="";h=i.FlightSegments.length==1?"NonStop":i.FlightSegments.length==2?"1 Stop":"2+ Stop";$.each(i.FlightSegments,function(t,i){var r="",u="",e="";f!=""&&(u=f,e=i.DepartureDateTime,r=timeDiff(e,u),c=Math.floor(Math.abs(r.minutes)/60),l=Math.abs(r.minutes)%60,n+="<tr><td colspan='5'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Layover: "+c+"H "+l+"M <\/td><\/tr>");f=i.ArrivalDateTime;var s=i.ElapsedTime,h=Math.trunc(s/60),a=s%60;i.OperatingAirline.Code=="AI"&&(isFlight_AI=!0);i.OperatingAirline.Code=="PK"&&(isFlight_PK=!0);n+="<tr>";n+=window.location.href.indexOf("/air")>-1?"<td><img src='/air/Content/Images/Airlines_Logo/"+i.MarketingAirline.Code+".gif'  alt=''><\/td>":"<td><img src='/Content/Images/Airlines_Logo/"+i.MarketingAirline.Code+".gif'  alt=''><\/td>";n+="<td><strong>"+Airline_Name(i.MarketingAirline.Code)+"<\/strong><br> Operated by <strong>"+Airline_Name(i.OperatingAirline.Code)+"<\/strong><br>  Flight # <strong>"+i.OperatingAirline.Code+"-"+i.OperatingAirline.FlightNumber+"<\/strong><\/td>";n+="<td><strong>"+$.formatDateTime("g:iia DD dd MM",new Date(i.DepartureDateTime))+"<br> "+$.formatDateTime("g:iia DD dd MM",new Date(i.ArrivalDateTime))+"<\/strong><\/td>";n+="<td><strong>"+AirPort_Name(i.DepartureAirport.LocationCode)+"<br> "+AirPort_Name(i.ArrivalAirport.LocationCode)+"<\/strong><\/td>";n+="<td class='rt-align'> Coach <br> "+h+"H "+a+"M<\/td>";n+="<\/tr>";o=o+1});r=i.ElapsedTime;u=Math.trunc(r/60);e=r%60;localStorage["flighthours"+t]=Math.trunc(r/60);localStorage["flightminutes"+t]=r%60;n+="<tr><td colspan='5'><i class='fa fa-clock-o' aria-hidden='true'><\/i> Total Trip Duration:  "+u+"H "+e+"M ("+h+")<\/td><\/tr>"});n+="<\/table>";n+="<\/div>"}),$("#Search-FlightSegments-Result-Panel").empty().append(n),n="",i=0,$.each(t,function(t,r){var f=r.FlightSegments[0].FlightSegmentID,u="";return n+="<div class='table-responsive' style=''>",n+="<table class='table without_tab'><thead id='pricedtl' style='border-top:1px;'><tr>",n+="<th>Passanger Type<\/th>",n+="<th style=''>Number of Passanger<\/th>",n+="<th class='text-right'>Base Fare<\/th>",n+="<th class='text-right'>Taxes &amp; Fees<\/th>",n+="<th class='text-right'>Total Price<\/th>",n+="<\/tr><\/thead>",n+="<tbody class='pink-bg_1 text-left'>",u=r.FlightSegments.length==1?"NonStop":r.FlightSegments.length==2?"1 Stop":"2+ Stop",$.each(r.FlightSegments,function(t,r){var u;if(i==0){i=i+1;var f=r.AirItineraryPricingInfo,e=0,o="";for($("#passengercnt").val(f.PTC_FareBreakdowns.PTC_FareBreakdown.length),u=0;u<f.PTC_FareBreakdowns.PTC_FareBreakdown.length;u++)f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Code=="ADT"?n+="<tr><td id='type"+u+"'> Adult<\/td>":f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Code=="C07"?n+="<tr><td id='type"+u+"'> Child<\/td>":f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Code=="INF"&&(n+="<tr><td id='type"+u+"'> Infant<\/td>"),n+="<td>"+f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Quantity+"<\/td>",n+="<td id='tripcost"+u+"' class='text-right'>"+parseFloat(f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Quantity*f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerFare.EquivFare.Amount).toFixed(2)+"<\/td>",n+="<td id='tax"+u+"' class='text-right'>"+parseFloat(f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Quantity*f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerFare.Taxes.TotalTax.Amount).toFixed(2)+"<\/td>",n+="<td id='price"+u+"' class='text-right'>"+parseFloat(f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Quantity*f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerFare.TotalFare.Amount).toFixed(2)+"<\/td><\/tr>",e=parseFloat(e)+parseFloat(f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerTypeQuantity.Quantity*f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerFare.TotalFare.Amount),o=f.PTC_FareBreakdowns.PTC_FareBreakdown[u].PassengerFare.EquivFare.CurrencyCode;n+="<tr><td colspan='3'><\/td><td><b>Grand Total<\/b><\/td><td class='text-right'>"+e.toFixed(2)+" "+o+"<\/td><\/tr>";n+="<\/tbody>";n+="<\/table>";n+="<div class='quoted-note'>Please note: All fares are quoted in "+sessionStorage.getItem("CurrencyCode")+". Some airlines may charge baggage fees.<\/div>"}}),n+="<\/div>",!1}),$("#Search-FlightTaxes-Result-Panel").empty().append(n)))}catch(f){e=f;e=f;HideWaitProgress()}}var SelectedAirLineBokingPayment_Data="",myPassengerDetailsListArray=[],FilterAllFlightSegment_Array=[],TotalAmount="",isFlight_AI=!1,isFlight_PK=!1,PaymentMethod="",CreditCardNumber=0,CreditCardName="",CreditCardExpDate="",CVV=0,UserLocation="",UserStreetAddress="",UserZip=0,UserPhone=0,UserEmail="",CCFEE=0,PublishFareMessage="",timeDiff;Math.trunc=Math.trunc||function(n){return isNaN(n)?NaN:n>0?Math.floor(n):Math.ceil(n)};$(document).on("change","#selPICCType",function(){var t=$(this).find(":selected").val(),n;t!="CQ"?($(".stat_col_payment").show(),$(".cc-section").show()):($(".stat_col_payment").hide(),$(".cc-section").hide());n=0;(isFlight_AI==!0||isFlight_PK==!0)&&t=="MX"&&(n=fpercent(TotalAmount,4.5));isFlight_AI==!0&&(t=="VI"||t=="MC")&&(n=fpercent(TotalAmount,3));$("#lblCCFee").text(n.toFixed(2));n>0&&$("#msgCCFee").html("<span style='color:red;'> (Separate charge of Credit Card fee will appear on the credit card)<\/span> ")});$(function(n){var t,r;sessionStorage.setItem("IsFromPaymentPage","True");t=sessionStorage.getItem("CompanyTypeId");GetOriginDestination();t=="1"&&(n(".stat_col_payment").hide(),n(".cc-section").hide());try{n("#txtPICCNumber").inputmask({Card:"XXXX-XXXX-XXXX-XXXXX"});n("#txtTDDOB").datepicker({autoclose:!0,format:"yyyy-mm-dd",todayHighlight:!0});n("#col_txtTDDOB").click(function(){n("#txtTDDOB").datepicker("show")});n("#txtPIVCNumber").keypress(function(t){if(t.which!=8&&t.which!=0&&(t.which<48||t.which>57))return ConfirmBootBox("Successfully","Please Enter Number Only.....","App_Warning",initialCallbackYes,initialCallbackNo),n("#txtPIVCNumber").focus(),!1});n("#txtPICCNumber").keypress(function(t){if(t.which!=8&&t.which!=0&&(t.which<48||t.which>57))return ConfirmBootBox("Successfully","Please Enter Number Only.....","App_Warning",initialCallbackYes,initialCallbackNo),n("#txtPICCNumber").focus(),!1})}catch(i){r=i}});$(document).ready(function(){$.each([{Key:"Jan (01)",Value:"01"},{Key:"Feb (02)",Value:"02"},{Key:"Mar (03)",Value:"03"},{Key:"Apr (04)",Value:"04"},{Key:"May (05)",Value:"05"},{Key:"Jun (06)",Value:"06"},{Key:"Jul (07)",Value:"07"},{Key:"Sep (08)",Value:"08"},{Key:"Sep (09)",Value:"09"},{Key:"Oct (10)",Value:"10"},{Key:"Nov (11)",Value:"11"},{Key:"Dec (12)",Value:"12"}],function(n,t){var i=t;$(".selectPICCMonth").append('<option value="'+i.Value+'">'+i.Key+"<\/option>")});$(".selectPICCYear").yearselect({order:"asc"})});$(document).ready(function(){GetPaymentOptions();window.location.href.indexOf("/Payments")>-1&&$.when(GetUserContactDetails()).done(function(){var n=SolutionDataTraveler("GET","AirReservationBookingResult");if(console.log("-------Atload------"),console.log(n),n!=null)n.Message=="Success"&&n.Status==!0?($(".AirBokingConfirmation-Panel").removeClass("hidden"),$(".AirBokingPayment-Panel").addClass("hidden"),LoadAirReservationResultData(n)):($(".AirBokingPayment-Panel").removeClass("hidden"),$(".AirBokingConfirmation-Panel").addClass("hidden"));else{$(".AirBokingPayment-Panel").removeClass("hidden");$(".AirBokingConfirmation-Panel").addClass("hidden");var t=parseFloat(sessionStorage.getItem("mapublishedfare")),i=parseFloat(sessionStorage.getItem("cpublishedfare")),r=t+i;(t>0||i>0)&&($("#lblServiceFee").html(r.toFixed(2)),$("#msgServiceFee").html("<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span> "));t>0&&i<=0&&($("#lblServiceFee").html(t.toFixed(2)),$("#msgServiceFee").html("<span style='color:red;'> (Separate charge of service fee will appear on the credit card)<\/span>"))}});$("#add-to-itinerary").click(function(){$(this).prop("checked")?$("#msg-includeinsurance").show():$("#msg-includeinsurance").hide()});var n=sessionStorage.getItem("Insurance");n=="True"?($("#insurance-options").show(),$("#no-insurance-options").hide()):($("#insurance-options").hide(),$("#no-insurance-options").show());$(".btn-success-booking").on("click",function(){ShowWaitProgress();$("#row1").html("Reservation of the selected fare is in progress");ValidateData()?AirBookingPaymentForm():HideWaitProgress()});$("#radiocancelinsurance").on("click",function(){$("#section-insurance-details").hide()});$("#radiobookinsurance").on("click",function(){var u,o,n,r,i,s;if(ShowWaitProgress(),ValidateInsuranceData()){for($("#row1").html("Searching for your best Insurance Plan"),$(".gisPreloader").css("top","29px;"),u=[],o=$("#passengercnt").val(),n=0;n<parseInt(o);n++){r=$("#type"+n).text().trim();i="";r=="Adult"?i="Adults":r=="Child"?i="Childrens":r=="Infant"&&(i="Infants");var t=new Date($("#txtDOBDate"+i+"0").val()),h=t.getFullYear().toString(),f="",e="";f=t.getMonth()<10?"0"+(t.getMonth()+1).toString():(t.getMonth()+1).toString();e=t.getDate()<10?"0"+(t.getDate()+1).toString():(t.getDate()+1).toString();s=h+f+e;u.push({BIRTHDATE:s,TRIPCOST:$("#tripcost"+n).text().trim(),AMTAFTER:"",PRICE:$("#price"+n).text().trim(),TAX:$("#tax"+n).text().trim()})}var c=sessionStorage.getItem("Origin_Final_Date"),l=sessionStorage.getItem("Destination_Final_Date"),a={DATEDEP:c,DATERET:l,PROVINCE:$("#selBCICountry").val().split(",")[1],NBPAX:$("#passengercnt").val(),PAXES:u};function v(n){var i,u,r,f,t;for(i=n,console.log(n),console.log(i.RESPONSE.Products[0].CODE),$("#hdpolicycode").val(i.RESPONSE.Products[0].CODE),u=parseFloat(i.RESPONSE.Products[0].PRICE)+parseFloat(i.RESPONSE.Products[0].TAX),$("#hdTotalPolicyAmount").val(parseFloat(u)),r="",r+="<p>Plan: "+i.RESPONSE.Products[0].NAME+" ( <a target='_blank' href='"+i.RESPONSE.Products[0].DESCURL+"'>Plan Details <\/a>)<\/p>",f=1,t=0;t<i.RESPONSE.Products[0].PAXES.length;t++)t==0?(r+="<p>Passenger "+parseInt(t+1)+" Insurance Price : "+sessionStorage.getItem("CurrencyCode")+" "+i.RESPONSE.Products[0].PAXES[t].PRICE+"<\/p>",$("#passenger"+t).val(parseFloat(i.RESPONSE.Products[0].PAXES[t].PRICE)+parseFloat(i.RESPONSE.Products[0].PAXES[t].Tax))):t==1?(r+="<p>Passenger "+parseInt(t+1)+" Insurance Price : "+sessionStorage.getItem("CurrencyCode")+" "+i.RESPONSE.Products[0].PAXES[t].PRICE+"<\/p>",$("#passenger"+t).val(parseFloat(i.RESPONSE.Products[0].PAXES[t].PRICE)+parseFloat(i.RESPONSE.Products[0].PAXES[t].Tax))):t==2&&(r+="<p>Passenger "+parseInt(t+1)+" Insurance Plan : "+sessionStorage.getItem("CurrencyCode")+" "+i.RESPONSE.Products[0].PAXES[t].PRICE+"<\/p>",$("#passenger"+t).val(parseFloat(i.RESPONSE.Products[0].PAXES[t].PRICE)+parseFloat(i.RESPONSE.Products[0].PAXES[t].Tax)));$("#section-insurance-details").show();$("#insurance-details").html(r);HideWaitProgress()}function y(){}MasterAppConfigurationsServices("POST",CommonConfiguration.WebAPIServicesURL+"API/AirReservationBooking/GetInsuranceQuote",JSON.stringify(a),v,y)}else $(this).prop("checked",!1),HideWaitProgress()});OnLoadCreateVailidatePassengerDetailsDynamically();BindDisplayResutModuleDataNew()});timeDiff=function(n,t){var r=new Date(n).getTime(),u=new Date(t).getTime(),i={};return i.milliseconds=r>u?r%u:u%r,i.seconds=i.milliseconds/1e3,i.minutes=i.seconds/60,i.hours=i.minutes/60,i.days=i.hours/24,i.weeks=i.days/7,i};$(function(){$("select#selPICCType").change()});